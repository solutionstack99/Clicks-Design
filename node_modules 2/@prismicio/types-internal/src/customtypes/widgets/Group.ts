import * as t from "io-ts"

import { WidgetKey } from "../../common"
import { StringOrNull } from "../../validators"
import { NestableWidget } from "./nestable/NestableWidget"

export const GroupFieldType = "Group"
export const GroupConfig = t.exact(
	t.partial({
		label: StringOrNull,
		repeat: t.boolean,
		fields: t.record(WidgetKey, NestableWidget),
	}),
)
export type GroupConfig = t.TypeOf<typeof GroupConfig>

export const Group = t.exact(
	t.intersection([
		t.type({
			type: t.literal(GroupFieldType),
		}),
		t.partial({
			fieldset: StringOrNull,
			icon: t.string,
			description: t.string,
			config: GroupConfig,
		}),
	]),
)
export type Group = t.TypeOf<typeof Group>
